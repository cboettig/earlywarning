% No evidence for stochastic transitions but baselines for warning signals remain a generic challenge

<!-- Intro: recap claims -->
Boettiger & Hastings [@Boettiger2012c] demonstrated that conditioning on observing a purely stochastic transition from one stable basin to another could generate time-series trajectories that could be mistaken for an early warning signal of a critical transition (such as might be due to a fold bifurcation; [@Scheffer2009], when instead the shift is merely due to chance.  While the goal was to highlight a potential danger in mining historical records for patterns showing sudden shifts when seeking to test early warning techniques, Drake [@Drake2013] draws attention to a potentially more interesting consequence of our analysis.  Drake argues that the bias observed could be used to forecast purely stochastic transitions -- a task previously thought to be impossible [See @Lenton2011 for a review of some of this literature].  Unfortunately, I feel this interpretation too generous and must agree with the prevailing opinion that early warning signals for purely stochastic transitions do not exist.  Drake demonstrates how the patterns presented in [@Boettiger2012c] show an indisputable difference between the time series that transition by chance and the much larger population of replicate time series driven by the identical mechanism that do not transition by chance.  Consequently, my position takes some explaining.  

<!-- Thesis -->
What is meant by having found evidence of an early warning signal?  Though this question may sound like philosophy, it is in fact a statistical issue that lies at the heart of both the present issue and a general challenge for the current literature on leading indicators. We can only define this relative to some null distribution or baseline indicating what we might expect when no warning signal is present. This question has so far received insufficient attention, empirical and theoretical, throughout the recent literature on the subject [@Boettiger2013].  Drake's analysis presents the choice of baseline or null distribution as the population of all replicates experiencing the identical dynamics.  I argue that the appropriate null distribution in this case would rather be only the subset of those trajectories that had experienced an equally large deviation (with or without experiencing a transition), rather than the entire population. After all, our goal is to detect approaching transitions before they happen, not merely detect large deviations after they happen.  

A numerical example shows that a similar pattern to that observed [@Boettiger2012c] can be seen in the large deviations of a purely stable system. This suggests that the pattern is not due to the curvature or any other feature of the chance transition, but only due to the conditional selection being biased to such chance transitions.  I also discuss some earlier analytic work which helps explain the patterns observed. 


<!-- numerical example --> 

We replicate the analysis of Boettiger and Hastings [@Boettiger2012c] using time series replicates produced by an OU process: a stochastic differential equation in which there is only a single optimum whose strength is proportional to the displacement,

$$ dX = - \alpha X dt + \sigma dBt $$

Instead of conditioning on trajectories that experience a large deviation, we condition on trajectories that experience a very large deviation. We then compute warning signals for each of these large deviation trajectories, and compare their distribution to that of the entire population of trajectories as shown in Figure 1. We note that the same bias is observed.  Observing the bias depends on having a rapid enough sample frequency to capture the escape trajectory and a long enough trajectory for the statistic to demonstrate an increase over time. This should help illustrate that observations we reported are driven by the large deviation preceding the transition, and are simply evidence of this fact and not of an impending transition per se.  While trajectories already far from the origin are more likely to transition than ones close to the average, such events can be trivially identified by comparing their states to the historical average.  



![Figure 1. Histogram shows the frequency the correlation statistic $\tau$ observed for each warning signal (variance, autocorrelation coefficient) on the large deviation samples.  Background distribution of all samples show by smooth line (kernel density estimate).  More positive values of tau are supposed to indicate a rising indicator which can be a signal of an approaching transition [@Scheffer2009].   $\alpha = 5$, $\sigma=3.5$, $t \in (0, 10)$, 2000 replicates, 20,000 sample points each.  Conditionally selected trajectories experiencing a deviation of at least -4, and analyzed the 1,500 data points prior to the threshold to determine a warning signal (Kendall's tau computed for the moving window average value for variance and autocorrelation, window of half the time series length, following @Dakos2008).  [code](https://github.com/cboettig/earlywarning/blob/7460ea94c293844d8e88c83b95e3d80004817de6/inst/examples/beer.md)](8594745411_b3f97ffb2a_o.png) 



<!-- Analytic proofs -->

The realization that the trajectories of large deviations have a pattern that looks like an early warning signal can be better understood in light of early work on large deviations.   @Boettiger2012c observes that any trajectory that does manage to escape by chance does so quickly. This rapid dash to the boundary results in an escape path that is highly autocorrelated and marked by a rapid increase in variance as it departs from the mean.  It turns out that we can be more precise about the speed of this trajectory: the expected transit time from the vicinity of the stable point to some distant deviation $L$ can be shown to scale as $\log(L/\sigma)$. This result is rather remarkable considering it is the very same scaling to go against the gradient, uphill, as the expected time to *return* downhill from that distant point $L$ to the neighborhood of the stable point!  For comparison, the waiting time to observe such a trajectory scales as $\exp(L^2/\sigma^2)$, such that we must wait a long time before observing such a path.  These results follow in the limit of $L \gg \epsilon$ for a region $\epsilon$ around the stable point and for small noise $\sigma \ll L$, and a careful walk through of the calculation can be found in @Mangel2006 for the OU process as considered here, which follows the derivation of @Ludwig1981.  This result actually has interesting applications in a variety of ecological and evolutionary contexts (e.g. Lande 1985 [@Lande1985] independently derives this in the context of transitions between adaptive peaks).  These results provide groundwork for a more general treatment of large deviations, see @Freidlin1998. It is a direct consequence of this rapid trajectory that the resulting pattern shows a sudden rise in variance and autocorrelation as the random walk follows its trajectory to the large deviation. 




<!-- Conclusion -->
Both the numerical and analytic lines of evidence suggest that pattern Drake alludes arises from the large deviation, rather than from some signal that the system approaches a stochastic transition per se. If we are to consider this a warning signal of stochastic transitions, it is only in this weak sense in which the signal can be seen in any large deviation rather than being sufficient evidence of the chance transition. The challenge of sufficient or unique early warning indicators is not limited to this case, but includes the more typical critical transitions.  For instance, rising variance or autocorrelation patterns typical of fold bifurcations can be observed in more benign bifurcations or smooth transitions [@Kefi2012]. Early warning signals may offer a promising technique that will one day allow us to avoid seemingly unpredictable catastrophes -- but we must not loose sight of just how difficult are the challenges involved. A key step here and for early warning indicators more generally is to understand these other circumstances in which they can arise, that we may then develop ways to eliminate those possibilities.  Though we may never be able to detect purely stochastic transitions, perhaps these tools will help develop more unique and sufficient indicators for true critical transitions.  


